% Network analysis of symbiotic association in *Lupinus*% Guanjing Hu% June, 2017# BackgroundInside a legume genus *Lupinus*, species may form symbiotic association with different bacteria species, or a specific relationship with only one species of bacteria. For example, *L. albus* can be associated with different bacteria species whereas *L. mariae-josephae* is specific to *Bradyrhizobium valentinum*.We are interested in genes which could be responsible for this specificity. Last year, we cultivated 3 lupine species with two different bacteria strains and three replicates each time (so we had compatible, and uncompatible situations). We performed RNAseq Illumina (High-seq 2000) sequencing for each replicates and we pooled all reads for each species (e.g : for L. albus, we pooled the three replicates with the first bacteria and the three replicates with the second bacteria in one file). Then, these super-datasets were subjected to Trinity (2.0.6) for assembly. Finally, chimeras were detected and removed. Below, a schema summarizing the process: ![](img/design.png)# About co-expression gene network analysis **Objectives**: We would like to construct the co-expression network for each species, and conduct comparative network analysis to find common sub-network structures or conserved functional modules (closely clustered genes with related biological functions) among three different *Lupinus* species.**Challenges**: For co-expression network construction based on Pearson correlation (r) matrix, it is not ideal to use only 6 samples per species, given the high level of noise due to small sample size. Therefore, describing topological details for individual species network is prone to errors, and direct network alignment (whether and how individual nodes and edges in one networking having counterparts in the other network) across species becomes even more problematic and sensitive to noise.Therefore, approporiate precautions should be taken into considerations; for example:- More stringent threshold should be applied to define co-expression relaionships, e.g. using higher cutoff for Pearson correlations to filter out weak edges.- Restrict network construction to those genes with strong biological signals, like genes exhibiting significant differential expression.- When analyzing network features, focus on module-level characteristics and avoid over-interpretation of changes on certain nodes and edges.- Always consider statistical significance of results before making conclusions.# Analytic workflow| Steps | PlanA | PlanB |      |-------|-------|-------||1| Network construction | Network construction ||2| Network alignment | Functional connectivity calculation  ||3| Identify conserved and diverged modules | Compare functional groups ||4| Annotate modules of interest |  ... |## Plan AWe tried several tools for its step 2 and 3, but failed to get them work:- [OrthoClust](https://github.com/gersteinlab/OrthoClust) (Yan et al, Genome Biology 2014) integrates networks built for individual species using orthology relationships of genes between species, which detects co-expression modules that range from being highly conserved cross species to species-specific. **Written in Julia.**- [isorankN](http://groups.csail.mit.edu/cb/mna/), a global multiple-network alignment tool based on spectral clustering on the induced graph of pairwise alignment scores. **Terminated when reading network matrix, reason unknown**- [multiMAGNA++](http://www3.nd.edu/~cone/multiMAGNA++/) is a method for multiple (global) network alignment. **Error reported reading node similarity files.**Other methods for network alignment were not tested, including [NetworkBlast-M](http://www.cs.tau.ac.il/%7Ebnet/License-nbm.htm), [GraphAlignment](http://bioconductor.org/packages/2.2/bioc/html/GraphAlignment.html), [SMAL](http://haddock6.sfsu.edu/smal/smal.py?page=home), [ModuleAlign](http://ttic.uchicago.edu/~hashemifar/ModuleAlign.html), [SANA](https://arxiv.org/abs/1607.02642), [Graemlin](http://graemlin.stanford.edu/download.php). Because those methods were mostly developed for protein-protein interaction network, which is more curated and much less dense (fewer edges!!) than co-expression gene network, it appears quite challenging to adapt methods to our datasets without better understanding of their computational algorithms.## Plan BThis workflow skipped network alignment or any direct comparisons of network topology, which could be a more suitable approach for our datasets, which generates very noisy networks. **Functional connectivity**(FC) refers to the degree how genes belong to a given functional category (e.g. GO annotation) are connected in network. Here, **higher FC in one species indicates potential functionality involved in forming symbiotic association with bacteria according to the "Guilt-By-Association" principle**. Functional categories that exhibit high FC consistently across three species are most likely to play an important role in symbiosis common to genus *Lupinus*, while highly connected functional groups specific to each species may indicate species-specific recruitment.Data analysis of Plan B was conducted in R:- R functions used by below scripts: [FC.FUN.r]- Step 1 & 2: [fc.r]()- Step 3: [fc.summary.r]() # Preliminary results## WGCNA outperforms other binary network construction methodsA series of networks were constructed for three species, based on their expression profiles ("`Proteins/3.LX_normCounts_nolowcounts_prot.txt`"). #### Table. Networks constructed for FC analysis per species| net | edge     | metric | cutoff | desc              ||-----|----------|--------|--------|-------------------|| 1   | binary   | rank   | 0.99   | binary.rank.0.99  || 2   | binary   | rank   | 0.995  | binary.rank.0.995 || 3   | binary   | Zscore | 2      | binary.Zscore.2   || 4   | binary   | Zscore | 2.5    | binary.Zscore.2.5 || 5   | binary   | Zscore | 3      | binary.Zscore.3   || 6   | weighted | wgcna  | 12     | weighted.wgcna.12 || 7   | weighted | wgcna  | 24     | weighted.wgcna.24 |Using the measurement of functional connectivity (FC) to evaluate how well the resulted network topology connects genes of similiar functions (GO, KEGG and the curated list of genes involved in symbiosis) together, WGCNA networks display higher FC (measured in AUCs) than other types of networks. Thus, following analysis and results were derived from WGCNA networks.![](img/plotFC.auc.png)## Thoughts about functional connectivity of pathwaysPreviously I planned to use KEGG pathway annotation to conduct FC analysis, as for GO annotations. Given that each mapped KO term (KEGG Orthology) refers to the molecular function of the annotated gene, KO terms need to be mapped to either reference pathway maps or organism-specific pathway maps. [Lupinus angustifolius](http://www.kegg.jp/kegg-bin/show_pathway?lang01100)